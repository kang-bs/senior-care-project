<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ê³µê³  ì‘ì„± - ì‚¬ëŒì´ìŒ</title>
    <script src="https://cdn.tailwindcss.com"></script>
      <script src="//dapi.kakao.com/v2/maps/sdk.js?appkey={{ kakao_key }}&libraries=services"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap"
      rel="stylesheet"
    />
    <style>
      /* ì‚¬ìš©ì ì •ì˜ í°íŠ¸ ë° ìŠ¤íƒ€ì¼ */
      body {
        font-family: "Noto Sans KR", sans-serif;
      }
      .btn-option.active {
        border-color: #2563eb;
        background-color: #2563eb;
        color: white;
      }
       /* --- ëª¨ë‹¬ ë° ì§€ë„ ìŠ¤íƒ€ì¼ (ìˆ˜ì •ë¨) --- */
      #addressModal {
        display: none; /* í‰ì†Œì—ëŠ” ìˆ¨ê¹€ */
        position: fixed;
        inset: 0; /* top, right, bottom, left: 0 */
        background-color: rgba(0, 0, 0, 0.6); /* ë°˜íˆ¬ëª… ë°°ê²½ */
        z-index: 1000;
        justify-content: center;
        align-items: center;
      }
      #addressModal .modal-card {
        width: 90vw;
        max-width: 500px;
        background: #fff;
        border-radius: 8px;
        overflow: hidden;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      }
      /* ì§€ë„ ì»¨í…Œì´ë„ˆ í¬ê¸° ì§€ì • (í•„ìˆ˜) */
      #addressMap {
        width: 100%;
        height: 400px;
      }
    </style>
  </head>
  <body class="bg-gray-100">
    <div class="max-w-sm mx-auto bg-white shadow-lg min-h-screen">
      <!-- ìƒë‹¨ ë°” -->
      <header
        class="sticky top-0 z-10 p-4 flex justify-between items-center bg-white shadow-sm"
      >
        <button class="p-2" onclick="history.back()">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="h-6 w-6"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
            stroke-width="2"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M15 19l-7-7 7-7"
            />
          </svg>
        </button>
        <h1 class="text-xl font-bold text-gray-800">ê³µê³  ì‘ì„±</h1>
        <div class="flex items-center gap-2">
          <a href="{{ url_for('job_assistant.general_job_assistant_page') }}" 
             class="p-2 text-green-600 hover:text-green-800" 
             title="AI ë„ìš°ë¯¸">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
            </svg>
          </a>
          <button
            class="text-blue-600 font-bold p-2"
            onclick="document.getElementById('jobForm').submit()"
        >
          ì €ì¥
        </button>
      </header>

      <!-- ë©”ì¸ ì»¨í…ì¸  -->
      <main class="p-4 bg-white pb-24">
        <form id="jobForm" method="POST" class="space-y-6">
          <!-- ê¸°ë³¸ ì •ë³´ -->
          <div>
            <label for="title" class="block text-sm font-medium text-gray-700"
              >ì œëª© <span class="text-red-500">*</span></label
            >
            <input
              type="text"
              name="title"
              id="title"
              class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"
              placeholder="ê³µê³  ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”"
              required
            />
          </div>

          <div>
            <label for="company" class="block text-sm font-medium text-gray-700"
              >ë‹´ë‹¹ìëª… <span class="text-red-500">*</span></label
            >
            <input
              type="text"
              name="company"
              id="company"
              class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"
              placeholder="ë‹´ë‹¹ìëª…ì„ ì…ë ¥í•˜ì„¸ìš”"
              required
            />
          </div>

          <div>
            <label class="block text-sm font-medium text-gray-700"
              >ëª¨ì§‘ í˜•íƒœ <span class="text-red-500">*</span></label
            >
            <div class="mt-2 grid grid-cols-2 gap-3">
              <button
                type="button"
                class="btn-option w-full py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50"
                data-value="ì •ê·œì§"
                onclick="selectRecruitmentType(this, 'ì •ê·œì§')"
              >
                ì •ê·œì§
              </button>
              <button
                type="button"
                class="btn-option w-full py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50"
                data-value="ì¼ìš©ì§"
                onclick="selectRecruitmentType(this, 'ì¼ìš©ì§')"
              >
                ì¼ìš©ì§
              </button>
            </div>
            <input
              type="hidden"
              name="recruitment_type"
              id="recruitment_type"
              required
            />
          </div>

          <div id="work_period_group" style="display: none">
            <label class="block text-sm font-medium text-gray-700"
              >ê·¼ë¬´ ê¸°ê°„ <span class="text-red-500">*</span></label
            >
            <div class="mt-2 grid grid-cols-3 gap-3">
              <button
                type="button"
                class="btn-option w-full py-2 px-2 border border-gray-300 rounded-md shadow-sm text-xs font-medium text-gray-700 bg-white hover:bg-gray-50"
                data-value="1ê°œì›” ì´ìƒ"
                onclick="selectWorkPeriod(this, '1ê°œì›” ì´ìƒ')"
              >
                1ê°œì›” ì´ìƒ
              </button>
              <button
                type="button"
                class="btn-option w-full py-2 px-2 border border-gray-300 rounded-md shadow-sm text-xs font-medium text-gray-700 bg-white hover:bg-gray-50"
                data-value="3ê°œì›” ì´ìƒ"
                onclick="selectWorkPeriod(this, '3ê°œì›” ì´ìƒ')"
              >
                3ê°œì›” ì´ìƒ
              </button>
              <button
                type="button"
                class="btn-option w-full py-2 px-2 border border-gray-300 rounded-md shadow-sm text-xs font-medium text-gray-700 bg-white hover:bg-gray-50"
                data-value="6ê°œì›” ì´ìƒ"
                onclick="selectWorkPeriod(this, '6ê°œì›” ì´ìƒ')"
              >
                6ê°œì›” ì´ìƒ
              </button>
            </div>
            <input type="hidden" name="work_period" id="work_period" />
          </div>

          <div>
            <label class="block text-sm font-medium text-gray-700"
              >ê·¼ë¬´ ìš”ì¼</label
            >
            <div class="mt-2 flex flex-wrap gap-4">
              <div class="flex items-center">
                <input
                  type="checkbox"
                  id="monday"
                  name="work_monday"
                  class="h-4 w-4 text-blue-600 border-gray-300 rounded"
                /><label for="monday" class="ml-2 block text-sm text-gray-900"
                  >ì›”</label
                >
              </div>
              <div class="flex items-center">
                <input
                  type="checkbox"
                  id="tuesday"
                  name="work_tuesday"
                  class="h-4 w-4 text-blue-600 border-gray-300 rounded"
                /><label for="tuesday" class="ml-2 block text-sm text-gray-900"
                  >í™”</label
                >
              </div>
              <div class="flex items-center">
                <input
                  type="checkbox"
                  id="wednesday"
                  name="work_wednesday"
                  class="h-4 w-4 text-blue-600 border-gray-300 rounded"
                /><label
                  for="wednesday"
                  class="ml-2 block text-sm text-gray-900"
                  >ìˆ˜</label
                >
              </div>
              <div class="flex items-center">
                <input
                  type="checkbox"
                  id="thursday"
                  name="work_thursday"
                  class="h-4 w-4 text-blue-600 border-gray-300 rounded"
                /><label for="thursday" class="ml-2 block text-sm text-gray-900"
                  >ëª©</label
                >
              </div>
              <div class="flex items-center">
                <input
                  type="checkbox"
                  id="friday"
                  name="work_friday"
                  class="h-4 w-4 text-blue-600 border-gray-300 rounded"
                /><label for="friday" class="ml-2 block text-sm text-gray-900"
                  >ê¸ˆ</label
                >
              </div>
              <div class="flex items-center">
                <input
                  type="checkbox"
                  id="saturday"
                  name="work_saturday"
                  class="h-4 w-4 text-blue-600 border-gray-300 rounded"
                /><label for="saturday" class="ml-2 block text-sm text-gray-900"
                  >í† </label
                >
              </div>
              <div class="flex items-center">
                <input
                  type="checkbox"
                  id="sunday"
                  name="work_sunday"
                  class="h-4 w-4 text-blue-600 border-gray-300 rounded"
                /><label for="sunday" class="ml-2 block text-sm text-gray-900"
                  >ì¼</label
                >
              </div>
            </div>
          </div>

          <div>
            <label class="block text-sm font-medium text-gray-700"
              >ê·¼ë¬´ ì‹œê°„</label
            >
            <div class="mt-1 flex items-center gap-2">
              <input
                type="time"
                name="work_start_time"
                class="block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"
              />
              <span>~</span>
              <input
                type="time"
                name="work_end_time"
                class="block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"
              />
            </div>
          </div>

            <div>
                <label for="salary" class="block text-sm font-medium text-gray-700"
                >ê¸‰ì—¬</label
                >
                <input
                        type="text"
                        name="salary"
                        id="salary"
                        class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"
                        placeholder="ì˜ˆ: ì‹œê¸‰ 10,000ì›"
                />
            </div>

            <!-- ê·¼ë¬´ ì§€ì—­ -->
            <div>
                <label for="region" class="block text-sm font-medium text-gray-700">ê·¼ë¬´ ì§€ì—­ <span
                        class="text-red-500">*</span></label>
                <div class="flex items-center gap-2">
                    <input type="text" name="region" id="region" readonly
                           class="mt-1 block w-full bg-gray-100 rounded-md border border-gray-300 shadow-sm"
                           placeholder="ì£¼ì†Œ ê²€ìƒ‰ ë²„íŠ¼ìœ¼ë¡œ ì„ íƒ" required/>
                    <button type="button" onclick="openAddressModal()"
                            class="py-2 px-4 bg-blue-600 text-white rounded-md text-sm hover:bg-blue-700 whitespace-nowrap">
                        ì£¼ì†Œ ê²€ìƒ‰
                    </button>
                </div>
            </div>


            <!-- ìˆ¨ì€ ìœ„ë„, ê²½ë„ í•„ë“œ -->
            <input type="hidden" id="latitude" name="latitude"/>
            <input type="hidden" id="longitude" name="longitude"/>

            <!-- ì£¼ì†Œ ì„ íƒ ëª¨ë‹¬ -->
            <div id="addressModal">
                <div class="modal-card">
                    <!-- ê²€ìƒ‰ UI ì¶”ê°€ -->
                    <div class="p-3 border-b">
                        <div class="flex gap-2">
                            <input type="text" id="addressSearchKeyword" class="flex-grow border rounded px-2 py-1"
                                   placeholder="ì£¼ì†Œë‚˜ ì¥ì†Œëª…ì„ ì…ë ¥í•˜ì„¸ìš”">
                            <button onclick="searchAddress()" class="bg-gray-200 px-3 rounded">ê²€ìƒ‰</button>
                        </div>
                    </div>
                    <div id="addressMap"></div>
                    <div class="flex justify-end p-3 border-t border-gray-200">
                        <button onclick="selectAddress()"
                                class="bg-blue-600 hover:bg-blue-700 text-white py-1 px-3 rounded-md text-sm mr-2">ì´ ìœ„ì¹˜ë¡œ
                            ì„ íƒ
                        </button>
                        <button onclick="closeAddressModal()"
                                class="bg-gray-500 hover:bg-gray-600 text-white py-1 px-3 rounded-md text-sm">ë‹«ê¸°
                        </button>
                    </div>
                </div>
            </div>

            <div>
                <label
                        for="recruitment_count"
                        class="block text-sm font-medium text-gray-700"
              >ëª¨ì§‘ ì¸ì›</label
            >
            <input
              type="number"
              name="recruitment_count"
              id="recruitment_count"
              class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"
              placeholder="ëª¨ì§‘ ì¸ì› ìˆ˜"
              min="1"
            />
          </div>

          <div>
            <label
              for="contact_phone"
              class="block text-sm font-medium text-gray-700"
              >ì—°ë½ì²˜</label
            >
            <input
              type="tel"
              name="contact_phone"
              id="contact_phone"
              class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"
              placeholder="ì—°ë½ ê°€ëŠ¥í•œ ì „í™”ë²ˆí˜¸"
            />
          </div>

          <div>
            <div class="flex justify-between items-center">
              <label
                for="description"
                class="block text-sm font-medium text-gray-700"
                >ìƒì„¸ ì„¤ëª… <span class="text-red-500">*</span></label
              >
              <button type="button" onclick="openAIAssistant()" 
                      class="text-xs text-green-600 hover:text-green-800 flex items-center gap-1 bg-transparent border-none cursor-pointer">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
                </svg>
                AI ë„ìš°ë¯¸
              </button>
            </div>
            <textarea
              name="description"
              id="description"
              rows="4"
              class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"
              placeholder="ì—…ë¬´ ë‚´ìš©, ìê²© ìš”ê±´ ë“±ì„ ìì„¸íˆ ì‘ì„±í•´ì£¼ì„¸ìš”&#10;&#10;ğŸ’¡ AI ë„ìš°ë¯¸ë¥¼ ì‚¬ìš©í•˜ë©´ ì‹œë‹ˆì–´ ì¹œí™”ì ì¸ ê³µê³ ë¥¼ ì‰½ê²Œ ì‘ì„±í•  ìˆ˜ ìˆì–´ìš”!"
              required
            ></textarea>
          </div>


          <div class="flex gap-4 pt-4">
            <button
              type="button"
              class="flex-1 w-full justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-gray-500 hover:bg-gray-600"
              onclick="history.back()"
            >
              ì·¨ì†Œ
            </button>
            <button
              type="submit"
              class="flex-1 w-full justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-800 hover:bg-blue-900"
            >
              ë“±ë¡í•˜ê¸°
            </button>
          </div>
        </form>
      </main>

      <!-- í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ -->
      <footer
        class="fixed bottom-0 left-0 right-0 max-w-sm mx-auto bg-gray-50 border-t flex justify-around"
      >
        <a
          href="#"
          class="flex-1 flex flex-col items-center justify-center p-2 text-gray-500"
        >
          <div class="w-6 h-6 mb-1 flex items-center justify-center">
            <img
              src="{{ url_for('static', filename='images/footer/map.png') }}"
              alt="ì§€ë„"
              class="max-w-full max-h-full object-contain"
            />
          </div>
          <span class="text-xs">ì§€ë„</span>
        </a>
        <a
          href="{{ url_for('jobs.bookmark_list') }}"
          class="flex-1 flex flex-col items-center justify-center p-2 text-gray-500"
        >
          <div class="w-6 h-6 mb-1 flex items-center justify-center">
            <img
              src="{{ url_for('static', filename='images/footer/favorite.png') }}"
              alt="ì°œ"
              class="max-w-full max-h-full object-contain"
            />
          </div>
          <span class="text-xs">ì°œ</span>
        </a>
        <a
          href="{{ url_for('auth.main') }}"
          class="flex-1 flex flex-col items-center justify-center p-2 text-gray-500"
        >
          <div class="w-6 h-6 mb-1 flex items-center justify-center">
            <img
              src="{{ url_for('static', filename='images/footer/home.png') }}"
              alt="í™ˆ"
              class="max-w-full max-h-full object-contain"
            />
          </div>
          <span class="text-xs">í™ˆ</span>
        </a>
        <a
          href="{{ url_for('chat.chat_list') }}"
          class="flex-1 flex flex-col items-center justify-center p-2 text-gray-500"
        >
          <div class="w-6 h-6 mb-1 flex items-center justify-center">
            <img
              src="{{ url_for('static', filename='images/footer/chatting.png') }}"
              alt="ì±„íŒ…"
              class="max-w-full max-h-full object-contain"
            />
          </div>
          <span class="text-xs">ì±„íŒ…</span>
        </a>
        <a
          href="{{ url_for('auth.profile') }}"
          class="flex-1 flex flex-col items-center justify-center p-2 text-gray-500"
        >
          <div class="w-6 h-6 mb-1 flex items-center justify-center">
            <img
              src="{{ url_for('static', filename='images/footer/profile.png') }}"
              alt="ë‚´ì •ë³´"
              class="max-w-full max-h-full object-contain"
            />
          </div>
          <span class="text-xs">ë‚´ì •ë³´</span>
        </a>
      </footer>
    </div>

    <script>
      function selectRecruitmentType(button, value) {
        document
          .querySelectorAll(".btn-option[data-value]")
          .forEach((btn) => btn.classList.remove("active"));
        button.classList.add("active");
        document.getElementById("recruitment_type").value = value;

        const workPeriodGroup = document.getElementById("work_period_group");
        if (value === "ì¼ìš©ì§") {
          workPeriodGroup.style.display = "block";
          document.getElementById("work_period").required = true;
        } else {
          workPeriodGroup.style.display = "none";
          document.getElementById("work_period").required = false;
          document.getElementById("work_period").value = "";
          document
            .querySelectorAll("#work_period_group .btn-option")
            .forEach((btn) => btn.classList.remove("active"));
        }
      }

      // ëª¨ë‹¬/ì§€ë„ ìƒíƒœ
      var addressModal = document.getElementById("addressModal");
      var addressMap, addressMarker, selectedPosition;
      var geocoder = new kakao.maps.services.Geocoder();
      var ps = new kakao.maps.services.Places();

      // ì£¼ì†Œë¡œ ê²€ìƒ‰í•˜ëŠ” í•¨ìˆ˜
      function searchAddress() {
          var keyword = document.getElementById('addressSearchKeyword').value;

          if (!keyword.replace(/^\s*|\s*$/g, '')) {
              alert('í‚¤ì›Œë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!');
              return false;
          }

          // ì¥ì†Œê²€ìƒ‰ ê°ì²´ë¥¼ í†µí•´ í‚¤ì›Œë“œë¡œ ì¥ì†Œê²€ìƒ‰ì„ ìš”ì²­í•©ë‹ˆë‹¤
          ps.keywordSearch(keyword, function (data, status, pagination) {
              if (status === kakao.maps.services.Status.OK) {
                  // ê²€ìƒ‰ëœ ì¥ì†Œ ìœ„ì¹˜ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì§€ë„ ë²”ìœ„ë¥¼ ì¬ì„¤ì •í•©ë‹ˆë‹¤
                  var bounds = new kakao.maps.LatLngBounds();

                  for (var i = 0; i < data.length; i++) {
                      bounds.extend(new kakao.maps.LatLng(data[i].y, data[i].x));
                  }

                   addressMap.setBounds(bounds);

                  // ì²« ë²ˆì§¸ ê²€ìƒ‰ ê²°ê³¼ì˜ ìœ„ì¹˜ë¡œ ë§ˆì»¤ì™€ ì¤‘ì‹¬ ì¢Œí‘œë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.
                  if (data.length > 0) {
                      var firstItem = data[0];
                      var moveLatLon = new kakao.maps.LatLng(firstItem.y, firstItem.x);

                      addressMap.setCenter(moveLatLon);
                      addressMarker.setPosition(moveLatLon);
                      selectedPosition = moveLatLon;
                  }
              } else if (status === kakao.maps.services.Status.ZERO_RESULT) {
                  alert('ê²€ìƒ‰ ê²°ê³¼ê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.');
                  return;
              } else if (status === kakao.maps.services.Status.ERROR) {
                  alert('ê²€ìƒ‰ ê²°ê³¼ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                  return;
              }
          });
      }

      // ì§€ë„ ìµœì´ˆ 1íšŒ ìƒì„±
      function initAddressMapOnce() {
          if (addressMap) return;
          var mapContainer = document.getElementById("addressMap");
          var mapOption = {
              center: new kakao.maps.LatLng(37.566826, 126.9786567),
              level: 3,
          };
          addressMap = new kakao.maps.Map(mapContainer, mapOption);

          addressMarker = new kakao.maps.Marker({
              position: addressMap.getCenter(),
              map: addressMap,
          });
          selectedPosition = addressMap.getCenter();

          // ì§€ë„ í´ë¦­ -> ì¢Œí‘œ ì„ íƒ ë° ë§ˆì»¤ ì´ë™
          kakao.maps.event.addListener(addressMap, "click", function (mouseEvent) {
              var latlng = mouseEvent.latLng;
              addressMarker.setPosition(latlng);
              selectedPosition = latlng;
          });
      }

      // ëª¨ë‹¬ ì—´ê¸° -> ë‹¤ìŒ í”„ë ˆì„ì— relayout + setCenter
      function openAddressModal() {
          addressModal.style.display = "flex";
          initAddressMapOnce();
          requestAnimationFrame(function () {
              addressMap.relayout();
              addressMap.setCenter(selectedPosition);
          });
      }

      // ì„ íƒ ì™„ë£Œ: ì¢Œí‘œ->ì£¼ì†Œ ë³€í™˜ í›„ í¼ ë°˜ì˜ (ìˆ˜ì •ë¨)
      function selectAddress() {
          if (!selectedPosition) {
              alert("ì§€ë„ì—ì„œ ìœ„ì¹˜ë¥¼ ë¨¼ì € í´ë¦­í•´ì£¼ì„¸ìš”.");
              return;
          }
          geocoder.coord2Address(
              selectedPosition.getLng(),
              selectedPosition.getLat(),
              function (result, status) {
                  if (status === kakao.maps.services.Status.OK) {
                      // Geocoder ê²°ê³¼ëŠ” ë°°ì—´ì´ë¯€ë¡œ ì²« ë²ˆì§¸(result[0]) ê²°ê³¼ë¥¼ ì‚¬ìš©
                      var roadAddr = result[0].road_address
                          ? result[0].road_address.address_name
                          : "";
                      var jibunAddr = result[0].address
                          ? result[0].address.address_name
                          : "";

                      document.getElementById("region").value = roadAddr || jibunAddr;
                      document.getElementById("latitude").value = selectedPosition.getLat();
                      document.getElementById("longitude").value = selectedPosition.getLng();
                      closeAddressModal();
                  } else {
                      alert("ì£¼ì†Œ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");
                  }
              }
          );
      }

      function closeAddressModal() {
          addressModal.style.display = "none";
      }

      function selectWorkPeriod(button, value) {
          document
          .querySelectorAll("#work_period_group .btn-option")
          .forEach((btn) => btn.classList.remove("active"));
        button.classList.add("active");
        document.getElementById("work_period").value = value;
      }

      document
        .getElementById("jobForm")
        .addEventListener("submit", function (e) {
          const recruitmentType =
            document.getElementById("recruitment_type").value;
          const workPeriod = document.getElementById("work_period").value;

          if (!recruitmentType) {
            alert("ëª¨ì§‘ í˜•íƒœë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.");
            e.preventDefault();
            return;
          }

          if (recruitmentType === "ì¼ìš©ì§" && !workPeriod) {
            alert("ê·¼ë¬´ ê¸°ê°„ì„ ì„ íƒí•´ì£¼ì„¸ìš”.");
            e.preventDefault();
            return;
          }
        });
    </script>

    <!-- AI ë„ìš°ë¯¸ ëª¨ë‹¬ -->
    <div id="aiAssistantModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
      <div class="flex items-center justify-center min-h-screen p-4">
        <div class="bg-white rounded-lg max-w-md w-full max-h-screen overflow-y-auto">
          <div class="p-4 border-b">
            <div class="flex justify-between items-center">
              <h3 class="text-lg font-bold text-gray-800">ğŸ¤– AI ìƒì„¸ ì„¤ëª… ìƒì„±</h3>
              <button onclick="closeAIAssistant()" class="text-gray-500 hover:text-gray-700">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                </svg>
              </button>
            </div>
          </div>
          
          <div class="p-4">
            <div class="mb-4 p-3 bg-blue-50 rounded-lg">
              <p class="text-sm text-blue-800">
                <strong>ğŸ’¡ ì…ë ¥ëœ ì •ë³´ë¥¼ ë°”íƒ•ìœ¼ë¡œ ìƒì„¸ ì„¤ëª…ì„ ìƒì„±í•©ë‹ˆë‹¤!</strong><br>
                ì¶”ê°€ ì •ë³´ë¥¼ ì…ë ¥í•˜ë©´ ë” ì™„ì„±ë„ ë†’ì€ ê³µê³ ë¥¼ ë§Œë“¤ ìˆ˜ ìˆì–´ìš”.
              </p>
            </div>

            <!-- ì¶”ê°€ ì •ë³´ ì…ë ¥ í¼ -->
            <div class="space-y-4">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">ì£¼ìš” ì—…ë¬´ (êµ¬ì²´ì ìœ¼ë¡œ)</label>
                <textarea id="aiDuties" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-md text-sm" 
                          placeholder="ì˜ˆ: ê³ ê° ì£¼ë¬¸ ë°›ê¸°, ìŒë£Œ ì œì¡°, ë§¤ì¥ ì²­ì†Œ"></textarea>
              </div>
              
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">ì–´ë–¤ ë¶„ì„ ì°¾ë‚˜ìš”?</label>
                <textarea id="aiRequirements" rows="2" class="w-full px-3 py-2 border border-gray-300 rounded-md text-sm" 
                          placeholder="ì˜ˆ: ì¹œì ˆí•˜ì‹  ë¶„, ì±…ì„ê° ìˆìœ¼ì‹  ë¶„"></textarea>
              </div>
              
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">í˜œíƒ / ì¢‹ì€ ì </label>
                <textarea id="aiBenefits" rows="2" class="w-full px-3 py-2 border border-gray-300 rounded-md text-sm" 
                          placeholder="ì˜ˆ: ì‹ì‚¬ ì œê³µ, êµí†µë¹„ ì§€ì›, ììœ ë¡œìš´ ë¶„ìœ„ê¸°"></textarea>
              </div>

              <!-- ì‹œë‹ˆì–´ ì¹œí™” ì˜µì…˜ -->
              <div class="border border-green-200 rounded-lg p-3 bg-green-50">
                <h4 class="text-sm font-medium text-green-800 mb-2">ğŸ¤ ì‹œë‹ˆì–´ ì¹œí™” ì˜µì…˜</h4>
                <div class="space-y-2">
                  <label class="flex items-center">
                    <input type="checkbox" id="aiSeniorFriendly" checked class="mr-2">
                    <span class="text-sm">ì‹œë‹ˆì–´ ì¹œí™”ì ìœ¼ë¡œ ì‘ì„±</span>
                  </label>
                  <label class="flex items-center">
                    <input type="checkbox" id="aiEasyWork" class="mr-2">
                    <span class="text-sm">ì‰¬ìš´ ì—…ë¬´ì„ì„ ê°•ì¡°</span>
                  </label>
                  <label class="flex items-center">
                    <input type="checkbox" id="aiTrainingProvided" class="mr-2">
                    <span class="text-sm">êµìœ¡ ì œê³µ</span>
                  </label>
                </div>
              </div>
            </div>

            <!-- ë²„íŠ¼ -->
            <div class="flex gap-2 mt-6">
              <button onclick="closeAIAssistant()" 
                      class="flex-1 px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50">
                ì·¨ì†Œ
              </button>
              <button onclick="generateAIDescription()" 
                      class="flex-1 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700">
                <span id="generateBtnText">ğŸ¤– AIë¡œ ìƒì„±í•˜ê¸°</span>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      // AI ë„ìš°ë¯¸ ëª¨ë‹¬ ì—´ê¸°
      function openAIAssistant() {
        // ê¸°ë³¸ í¼ ë°ì´í„° ê²€ì¦
        const title = document.querySelector('input[name="title"]').value.trim();
        const company = document.querySelector('input[name="company"]').value.trim();
        
        if (!title) {
          alert('ì œëª©ì„ ë¨¼ì € ì…ë ¥í•´ì£¼ì„¸ìš”.');
          return;
        }
        
        if (!company) {
          alert('ë‹´ë‹¹ìëª…ì„ ë¨¼ì € ì…ë ¥í•´ì£¼ì„¸ìš”.');
          return;
        }
        
        document.getElementById('aiAssistantModal').classList.remove('hidden');
      }

      // AI ë„ìš°ë¯¸ ëª¨ë‹¬ ë‹«ê¸°
      function closeAIAssistant() {
        document.getElementById('aiAssistantModal').classList.add('hidden');
      }

      // AI ìƒì„¸ ì„¤ëª… ìƒì„±
      async function generateAIDescription() {
        const generateBtn = document.getElementById('generateBtnText');
        generateBtn.innerHTML = 'ğŸ”„ ìƒì„± ì¤‘...';
        
        try {
          // ê¸°ë³¸ í¼ ë°ì´í„° ìˆ˜ì§‘
          const formData = collectFormData();
          
          // ì¶”ê°€ ì •ë³´ ìˆ˜ì§‘
          formData.duties = document.getElementById('aiDuties').value.trim() || 'ì—…ë¬´ ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”';
          formData.requirements = document.getElementById('aiRequirements').value.trim();
          formData.benefits = document.getElementById('aiBenefits').value.trim();
          formData.senior_friendly = document.getElementById('aiSeniorFriendly').checked;
          formData.easy_work = document.getElementById('aiEasyWork').checked;
          formData.training_provided = document.getElementById('aiTrainingProvided').checked;
          formData.job_type = 'general';

          // ë””ë²„ê¹…: ìˆ˜ì§‘ëœ ë°ì´í„° í™•ì¸
          console.log('ìˆ˜ì§‘ëœ í¼ ë°ì´í„°:', formData);

          const response = await fetch('/api/job-draft', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify(formData)
          });

          const result = await response.json();

          if (result.success) {
            // ìƒì„±ëœ ì„¤ëª…ì„ textareaì— ì…ë ¥
            const descriptionTextarea = document.getElementById('description');
            descriptionTextarea.value = result.content.description;
            
            // ëª¨ë‹¬ ë‹«ê¸°
            closeAIAssistant();
            
            // ì„±ê³µ ë©”ì‹œì§€
            alert('âœ¨ AIê°€ ìƒì„¸ ì„¤ëª…ì„ ìƒì„±í–ˆìŠµë‹ˆë‹¤! í•„ìš”ì— ë”°ë¼ ìˆ˜ì •í•´ì£¼ì„¸ìš”.');
          } else {
            alert('ìƒì„± ì‹¤íŒ¨: ' + result.error);
          }
        } catch (error) {
          alert('ì„œë²„ ì˜¤ë¥˜: ' + error.message);
        } finally {
          generateBtn.innerHTML = 'ğŸ¤– AIë¡œ ìƒì„±í•˜ê¸°';
        }
      }

      // í¼ ë°ì´í„° ìˆ˜ì§‘ í•¨ìˆ˜
      function collectFormData() {
        const formData = {
          title: document.querySelector('input[name="title"]').value.trim() || 'ì¼ìë¦¬ ê³µê³ ',
          company: document.querySelector('input[name="company"]').value.trim() || 'íšŒì‚¬ëª…',
          location: document.querySelector('input[name="region"]').value.trim() || 'ì„œìš¸',
        };

        // ëª¨ì§‘ í˜•íƒœ
        const recruitmentTypeBtn = document.querySelector('.btn-option.active[data-value]');
        if (recruitmentTypeBtn) {
          formData.employment_type = recruitmentTypeBtn.getAttribute('data-value');
        } else {
          // ì„ íƒëœ ë²„íŠ¼ì´ ì—†ìœ¼ë©´ ê¸°ë³¸ê°’ ì„¤ì •
          formData.employment_type = 'ì •ê·œì§';
        }

        // ê·¼ë¬´ ìš”ì¼
        const workDays = [];
        const dayCheckboxes = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday', 'sunday'];
        const dayNames = ['ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† ', 'ì¼'];
        
        dayCheckboxes.forEach((day, index) => {
          const checkbox = document.querySelector(`input[name="work_${day}"]`);
          if (checkbox && checkbox.checked) {
            workDays.push(dayNames[index]);
          }
        });
        
        if (workDays.length > 0) {
          formData.work_days = workDays.join('');
        }

        // ê·¼ë¬´ ì‹œê°„
        const startTime = document.querySelector('input[name="work_start_time"]').value;
        const endTime = document.querySelector('input[name="work_end_time"]').value;
        if (startTime && endTime) {
          formData.work_time = `${startTime}~${endTime}`;
        }

        // ê¸‰ì—¬
        const salary = document.querySelector('input[name="salary"]').value.trim();
        if (salary) {
          formData.salary = salary;
        }

        // ëª¨ì§‘ ì¸ì›
        const recruitmentCount = document.querySelector('input[name="recruitment_count"]').value.trim();
        if (recruitmentCount) {
          formData.recruitment_count = recruitmentCount;
        }

        // ì—°ë½ì²˜
        const contact = document.querySelector('input[name="contact_phone"]').value.trim();
        if (contact) {
          formData.contact_phone = contact;
        }

        return formData;
      }

      // ëª¨ë‹¬ ì™¸ë¶€ í´ë¦­ ì‹œ ë‹«ê¸°
      document.getElementById('aiAssistantModal').addEventListener('click', function(e) {
        if (e.target === this) {
          closeAIAssistant();
        }
      });
    </script>
  </body>
</html>
